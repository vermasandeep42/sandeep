{% extends 'base.html' %}

{% block content %}
<div style="max-width: 800px; margin: 0 auto;">
    <div class="card">
        <div style="border-bottom: 1px solid var(--border); padding-bottom: 1rem; margin-bottom: 1rem;">
            <h2 style="margin: 0;">Chat with {{ other_user.username }}</h2>
        </div>

        <div class="chat-container" id="chat-box">
            {% for message in messages %}
            <div class="message {% if message.sender == request.user %}sent{% else %}received{% endif %}">
                <div>{{ message.content }}</div>
                <small style="opacity: 0.7; font-size: 0.75rem;">{{ message.timestamp|date:"H:i" }}</small>
            </div>
            {% endfor %}
        </div>

        <form method="post" style="display: flex; gap: 1rem;">
            {% csrf_token %}
            <input type="text" name="content" class="form-control" placeholder="Type a message..." required
                autocomplete="off">
            <button type="submit" class="btn btn-primary">Send</button>
        </form>
    </div>
</div>

<script>
    // Scroll to bottom of chat
    const chatBox = document.getElementById('chat-box');
    chatBox.scrollTop = chatBox.scrollHeight;
</script>
{% endblock %}